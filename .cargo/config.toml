[net]
git-fetch-with-cli = true

[target.aarch64-apple-darwin]
rustflags = [
    "-C", "link-args=-Wl,-no_warn_duplicate_libraries",
    # Statically link zstd and libunwind to avoid Homebrew runtime dependencies
    "-C", "link-args=-Wl,-force_load,/opt/homebrew/opt/zstd/lib/libzstd.a",
    "-C", "link-args=-Wl,-force_load,/opt/homebrew/opt/llvm@18/lib/libunwind.a",
    # Remove unused dylibs after static linking
    "-C", "link-args=-Wl,-dead_strip_dylibs",
]

[target.x86_64-apple-darwin]
rustflags = [
    "-C", "link-args=-Wl,-no_warn_duplicate_libraries",
    # Statically link zstd and libunwind to avoid Homebrew runtime dependencies
    "-C", "link-args=-Wl,-force_load,/usr/local/opt/zstd/lib/libzstd.a",
    "-C", "link-args=-Wl,-force_load,/usr/local/opt/llvm@18/lib/libunwind.a",
    # Remove unused dylibs after static linking
    "-C", "link-args=-Wl,-dead_strip_dylibs",
]
